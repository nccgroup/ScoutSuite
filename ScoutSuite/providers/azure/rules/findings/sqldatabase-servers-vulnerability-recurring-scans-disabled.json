{
    "description": "Periodic Recurring Scans Is Disabled on SQL Servers",
    "rationale": "ADS -VA setting 'Periodic recurring scans' schedules periodic (weekly) vulnerability scanning for the SQL server and corresponding Databases. Periodic and regular vulnerability scanning provides risk visibility based on updated known vulnerability signatures and best practices.",
    "remediation": "In the Azure console: <ol> <li>Go to <samp>SQL servers</samp></li><li>For each server instance</li><li>Click on <samp>Advanced Data Security</samp></li><li>Set <samp> Advanced Data Security to On</samp> if not already</li><li>In Section <samp>Vulnerability Assessment Settings</samp>, set <samp>Storage Accounts</samp> if not already</li><li>Toggle 'Periodic recurring scans' ton ON</li><li>Click <samp>Save</samp></li></ol>",
    "compliance": [
        {
            "name": "CIS Microsoft Azure Foundations",
            "version": "1.2.0",
            "reference": "4.2.6"
        }
    ],
    "references": [
        "https://docs.microsoft.com/en-us/azure/azure-sql/database/sql-vulnerability-assessment",
        "https://docs.microsoft.com/en-us/rest/api/sql/servervulnerabilityassessments/listbyserver",
        "https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Update-AzSqlServerVulnerabilityAssessmentSetting?view=azps-5.5.0&viewFallbackFrom=azps-2.6.0",
        "https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Get-AzSqlServerVulnerabilityAssessmentSetting?view=azps-5.5.0&viewFallbackFrom=azps-2.6.0",
        "https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-posture-vulnerability-management#pv-6-perform-software-vulnerability-assessments"
    ],
    "dashboard_name": "SQL Servers",
    "display_path": "sqldatabase.subscriptions.id.servers.id",
    "path": "sqldatabase.subscriptions.id.servers.id",
    "conditions": [
        "and",
        [
            "sqldatabase.subscriptions.id.servers.id.server_vulnerability.recurring_scans_enabled",
            "false",
            ""
        ]
    ],
    "id_suffix": "server_vulnerability_recurring_scans_enabled"
}